<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Step-by-step guide for applying the DDR method. Guides you from training a fasttext model,  finding keywords, finding combinations of keywords, evaluating your dictionary, applying it and  inspecting results.
">
<title>from_text_to_measurement • dictvectoR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="from_text_to_measurement">
<meta property="og:description" content="Step-by-step guide for applying the DDR method. Guides you from training a fasttext model,  finding keywords, finding combinations of keywords, evaluating your dictionary, applying it and  inspecting results.
">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dictvectoR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/from_text_to_measurement.html">from_text_to_measurement</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/thieled/dictvectoR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>from_text_to_measurement</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/thieled/dictvectoR/blob/HEAD/vignettes/from_text_to_measurement.Rmd" class="external-link"><code>vignettes/from_text_to_measurement.Rmd</code></a></small>
      <div class="d-none name"><code>from_text_to_measurement.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/thieled" class="external-link">dictvectoR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pommedeterresautee/fastrtext" class="external-link">fastrtext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://quanteda.io" class="external-link">quanteda</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette guides you through the workflow described in Thiele
(2022) in applying the ‘Distributed Dictionary Representation’ (DDR)
Method (Garten et al., 2018) and introduces most functions of the
dictvectoR package.</p>
<p>The DDR method provides a continuous measurement of a concept in a
dataset of documents. This measurement is obtained by calculating an
average word vector representation of a concept dictionary, and
representations of each document, and calculating the cosine similarity
between those two vectors. For a detailed description, see Garten et
al. (2018) and Thiele (2022).</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The workflow described here starts from scratch, using only textual
data as input, guides through steps for finding inductively a list of
keywords, and demonstrates the evaluation and application.</p>
<p>It requires a population dataset containing textual data and a
hand-coded sample drawn from this dataset, annotated for the presence of
a theoretical concept. We use the built-in dataset <code>tw_data</code>
as population data and <code>tw_annot</code> as annotated sample.</p>
<p>The vignette follows these steps:</p>
<ol style="list-style-type: decimal">
<li><p>Pre-process data</p></li>
<li><p>Train fastText model</p></li>
<li><p>Finding keywords</p></li>
<li><p>Add multi-words</p></li>
<li><p>Get F1 scores</p></li>
<li><p>Drop similar terms</p></li>
<li><p>Narrowing down by hand</p></li>
<li><p>Get combinations of terms.</p></li>
<li><p>Evaluate performance of combinations.</p></li>
<li><p>Apply best performing dictionary.</p></li>
<li><p>Face validity.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="pre-process-data">Pre-process data<a class="anchor" aria-label="anchor" href="#pre-process-data"></a>
</h2>
<p>First we load and pre-process the built in textual data.</p>
<p><code>clean_text</code> cleans the text and is tailored to
German-speaking texts on social media. If you are using text in other
languages, you may want to adapt this helper-function to your own
needs.</p>
<p><code>prepare_train_data</code> prepares textual data for training a
fastText model. It tokenizes longer documents into sentences, shuffles
them, and calls <code>clean_text</code> with fixed settings.</p>
<p>We first prepare a <code>texts</code> character vector for training
the fastText model, and clean the text in <code>tw_data</code> and
<code>tw_annot</code> for our later analyses.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare text data</span></span>
<span><span class="va">texts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_train_data.html">prepare_train_data</a></span><span class="op">(</span><span class="va">tw_data</span>, text_field <span class="op">=</span> <span class="st">"full_text"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean text in tw_data</span></span>
<span><span class="va">tw_data</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/clean_text.html">clean_text</a></span><span class="op">(</span>remove_stopwords <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                        text_field <span class="op">=</span> <span class="st">"full_text"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean text in tw_annot</span></span>
<span><span class="va">tw_annot</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/clean_text.html">clean_text</a></span><span class="op">(</span>remove_stopwords <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                         text_field <span class="op">=</span> <span class="st">"full_text"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="train-fasttext-model">Train fastText model<a class="anchor" aria-label="anchor" href="#train-fasttext-model"></a>
</h2>
<p>Now, we train our own fastText model using
<code><a href="https://pommedeterresautee.github.io/fastrtext/reference/build_vectors.html" class="external-link">fastrtext::build_vectors</a></code>.</p>
<p>A customized word vector model has the advantage that it maps the
words and contexts that actually appear in the studied material. This is
important here, as we will use the vocabulary of the model as starting
point for our conceptual dictionary.</p>
<p>The downside of training your own model is that it is expensive
regarding memory and computation. I used a machine with a CPU @ 1.80GHz
processor with 8 cores and 16 GB RAM. If you run into memory
limitations, consider decreasing <code>dim</code>, the number of
dimensions. Decreasing the number of <code>epochs</code> will speed up
the learing process, and decreasing the <code>bucket</code> size will
reduce the size of the resulting model. For details, see Bojanowski et
al. (2017). To obtain a model with better quality, you also should
consider increasing the size of textual data used for training. The
example here is limited by the size of data that can be feasibly shipped
in a R-package.</p>
<p>Alternatively, you may consider using a pre-trained model from <a href="https://github.com/facebookresearch/fastText/blob/master/docs/crawl-vectors.md" class="external-link">here</a>.</p>
<p>The code below creates a local folder <code>ft_model</code> in your
user home directory, and saves the model as two files:
<code>ft_model.bin</code> and <code>ft_model.vec</code>.</p>
<p>(Note: To obtain a model that is reproducible every time we re-run
the code below, we use only one core by setting <code>thread = 1</code>.
To increase speed, you may want to use more threads.)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create local folder and set name for model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"~/ft_model"</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">model_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/path.expand.html" class="external-link">path.expand</a></span><span class="op">(</span><span class="st">"~/ft_model/ft_model"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train a fasttext model using the twitter data (if model does not yet exist)</span></span>
<span></span>
<span></span>
<span>  <span class="fu">fastrtext</span><span class="fu">::</span><span class="fu"><a href="https://pommedeterresautee.github.io/fastrtext/reference/build_vectors.html" class="external-link">build_vectors</a></span><span class="op">(</span><span class="va">texts</span>, <span class="va">model_file</span>, modeltype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"skipgram"</span><span class="op">)</span>,</span>
<span>                              dim <span class="op">=</span> <span class="fl">150</span>, epoch <span class="op">=</span> <span class="fl">10</span>, bucket <span class="op">=</span> <span class="fl">1e+6</span>,  lr <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                              lrUpdateRate <span class="op">=</span> <span class="fl">100</span>, maxn <span class="op">=</span> <span class="fl">7</span>,  minn <span class="op">=</span> <span class="fl">4</span>, minCount <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                              t <span class="op">=</span> <span class="fl">1e-04</span>, thread <span class="op">=</span> <span class="fl">1</span>, ws<span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span> <span class="co"># }</span></span>
<span>  </span></code></pre></div>
<p>Let’s load the model and use a nearest-neighbor query to check if it
works properly. ‘Spahn’ is the name of the former German minister of
health:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load model:</span></span>
<span><span class="va">model_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/path.expand.html" class="external-link">path.expand</a></span><span class="op">(</span><span class="st">"~/ft_model/ft_model.bin"</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">fastrtext</span><span class="fu">::</span><span class="fu"><a href="https://pommedeterresautee.github.io/fastrtext/reference/load_model.html" class="external-link">load_model</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">model_path</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Nearest-neigbor query:</span></span>
<span><span class="fu">fastrtext</span><span class="fu">::</span><span class="fu"><a href="https://pommedeterresautee.github.io/fastrtext/reference/get_nn.html" class="external-link">get_nn</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"spahn"</span>, k<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt;          spahns            jens   spahnversagen spahnruecktritt    maskenaffäre </span></span>
<span><span class="co">#&gt;       0.9231457       0.8296310       0.7667315       0.7490762       0.7094842 </span></span>
<span><span class="co">#&gt;   maskenskandal        empfängt   ffpzweimasken </span></span>
<span><span class="co">#&gt;       0.7067993       0.7042576       0.6780393</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="finding-keywords">Finding keywords<a class="anchor" aria-label="anchor" href="#finding-keywords"></a>
</h2>
<p>Next, we want to use the fastText model and the manually annotated
dataset to find a short dictionary for populist communication.</p>
<p>First, we split the annotated data into a train and a test sample,
using <code><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html" class="external-link">caret::createDataPartition</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get index for splitting</span></span>
<span><span class="va">train_id</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html" class="external-link">createDataPartition</a></span><span class="op">(</span><span class="va">tw_annot</span><span class="op">$</span><span class="va">pop</span>,</span>
<span>                                times <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                p <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>                                list <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co"># split annotated data</span></span>
<span><span class="va">df_train</span> <span class="op">&lt;-</span> <span class="va">tw_annot</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="va">train_id</span><span class="op">)</span> </span>
<span><span class="va">df_test</span> <span class="op">&lt;-</span> <span class="va">tw_annot</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="op">-</span><span class="va">train_id</span><span class="op">)</span> </span></code></pre></div>
<p>As starting point for our dictionary, we use the vocabulary from the
fastText model. We add the ID from the vocabulary and use
<code>clean_text</code> to remove stopwords, and drop words of less than
3 characters from this list:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># # Get vocabulary</span></span>
<span><span class="va">vocab_df</span> <span class="op">&lt;-</span> <span class="fu">fastrtext</span><span class="fu">::</span><span class="fu"><a href="https://pommedeterresautee.github.io/fastrtext/reference/get_dictionary.html" class="external-link">get_dictionary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>words <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get vocabulary ID</span></span>
<span><span class="va">vocab_df</span><span class="op">$</span><span class="va">word_id</span> <span class="op">&lt;-</span> <span class="fu">fastrtext</span><span class="fu">::</span><span class="fu"><a href="https://pommedeterresautee.github.io/fastrtext/reference/get_word_ids.html" class="external-link">get_word_ids</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">vocab_df</span><span class="op">$</span><span class="va">words</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove stopwords</span></span>
<span><span class="va">vocab_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_text.html">clean_text</a></span><span class="op">(</span><span class="va">vocab_df</span>, </span>
<span>                       text_field <span class="op">=</span> <span class="st">"words"</span>,</span>
<span>                       remove_stopwords <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n_words</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>                   <span class="va">n_chars</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<p>Next, we want to narrow down that list. We identify words that are
similar to the hand-coded corpus of populist Tweets but dissimilar to
non-populist Tweets in <code>df_train</code> using
<code>find_distinctive</code>.</p>
<p><code>find_distinctive</code> computes an average representation of
that subset of the annotated corpus in which populism was coded as
present, as well as a representation of the negative counterpart,
i.e. of the non-populist corpus. It then computes the cosine
similarities of each word in a dataframe to these two corpora, and
calculates the difference between these two similarity scores. This
provides us with a quick and computationally inexpensive shortcut to
find keywords that capture a specific concept, but nothing else.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get distinctive word scores</span></span>
<span><span class="va">vocab_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_distinctive.html">find_distinctive</a></span><span class="op">(</span><span class="va">df_train</span>, </span>
<span>                             concept_field <span class="op">=</span> <span class="st">"pop"</span>,</span>
<span>                             text_field <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                             word_df <span class="op">=</span> <span class="va">vocab_df</span>,</span>
<span>                             word_field <span class="op">=</span> <span class="st">"words"</span>,</span>
<span>                             model <span class="op">=</span> <span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vocab_df</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pop_distinctiveXpossim <span class="op">=</span> <span class="va">pop_distinctive</span><span class="op">*</span><span class="va">pop_possim</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="../reference/filter_ntile.html">filter_ntile</a></span><span class="op">(</span><span class="st">"pop_distinctiveXpossim"</span>, <span class="fl">.75</span><span class="op">)</span></span></code></pre></div>
<p>However, this method of narrowing down a list of keywords is a bit
crude and not very informative for assessing how well a single word
would perform when used in the DDR method.</p>
<p>Hence, we want to get the actual F1 scores for each single word, when
used as a one-word-dicitonary in the DDR method. Note that the DDR
method returns the cosine similarity as a continuous measure,
theoretically ranging from -1 to +1, while our manually annotated
dataset was coded in a binary fashion (populist or non-populist).</p>
<p>To solve this problem, the continuous measure is used as a
independent variable in a logistic regression, predicting the manual
binary coding. To obtain Recall, Precision and F1 scores,
<code>dictvectoR</code> compares the binary predictions resulting from
this regression with the manual coding. This is not a direct gold
standard test but circumvents the problem of producing reliable granular
codes manually (Grimmer &amp; Stewart, 2013, p. 275).</p>
<p>Recall is an evaluation metric that indicates how well the automated
measure captures all true positives, precision is indicates how well it
captures only true positives, and F1 is a harmonic mean of both
(Chinchor 1992).</p>
<p><code>get_many_F1s</code> is a function that efficiently returns F1
scores for a list of words or dictionaries, when used in as dictionary
in the DDR method.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vocab_df</span><span class="op">$</span><span class="va">popF1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_many_F1s.html">get_many_F1s</a></span><span class="op">(</span><span class="va">vocab_df</span><span class="op">$</span><span class="va">words</span>,</span>
<span>                              model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                              df <span class="op">=</span> <span class="va">df_train</span>,</span>
<span>                              reference <span class="op">=</span> <span class="st">"pop"</span><span class="op">)</span></span></code></pre></div>
<p>We’re only interested in the best-performing quartile, which we
extract using the helper-function <code>filter_ntile</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top</span> <span class="op">&lt;-</span> <span class="va">vocab_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  </span>
<span>            <span class="fu"><a href="../reference/filter_ntile.html">filter_ntile</a></span><span class="op">(</span><span class="st">"popF1"</span>, <span class="fl">.75</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">popF1</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-multi-words">Add multi-words<a class="anchor" aria-label="anchor" href="#add-multi-words"></a>
</h2>
<p>Some concepts are expressed rather in multi-word expressions than by
single words. In our case, we suspect that people-centrism, one core
dimension of populism, may involve such multiword expressions, for
example by constructing an in-group with references to some ‘we’, e.g.,
‘we taxpayers’, ‘our land’ etc.</p>
<p>To find common multiword expressions, we use the population data
(that is 75 percent of it to speed up the process a bit), and tokenize
it using <code><a href="https://quanteda.io/reference/tokens.html" class="external-link">quanteda::tokens</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tw_data</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n_words</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use 75% sample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">tw_split</span> <span class="op">&lt;-</span> <span class="va">tw_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tokenize</span></span>
<span><span class="va">toks</span> <span class="op">&lt;-</span> <span class="fu">quanteda</span><span class="fu">::</span><span class="fu"><a href="https://quanteda.io/reference/tokens.html" class="external-link">tokens</a></span><span class="op">(</span><span class="va">tw_split</span><span class="op">$</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<p><code>add_multiwords</code> adds multiword expressions for a
dataframe of single words and counts the occurences. Here we only look
for multiwords in a 2-word-window (<code>level = 1</code>), which can be
increased to a 3-words window (<code>level = 2</code>). This process
might take two or three minutes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_multiwords.html">add_multiwords</a></span><span class="op">(</span><span class="va">top</span>, </span>
<span>                      tokens <span class="op">=</span> <span class="va">toks</span>, </span>
<span>                      min_hits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      word_field <span class="op">=</span> <span class="st">"words"</span>,</span>
<span>                      levels <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Finding multi-word expressions in window = 1..."</span></span>
<span><span class="co">#&gt; Joining, by = "from"</span></span>
<span><span class="co">#&gt; [1] "Adding missing count of original words:"</span></span>
<span><span class="co">#&gt; [1] "Counting word occurrences..."</span></span></code></pre></div>
<p>We want to narrow down this list again, dropping terms that occur
only once. And we add a unique word_id by <code>add_word_id</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">hits</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> </span>
<span><span class="va">top</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/add_word_id.html">add_word_id</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-f1-scores">Get F1 scores<a class="anchor" aria-label="anchor" href="#get-f1-scores"></a>
</h2>
<p>Now, we also want to know the F1 scores for the new multiword terms,
hence we just run <code>get_many_F1s</code> again.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top</span><span class="op">$</span><span class="va">popF1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_many_F1s.html">get_many_F1s</a></span><span class="op">(</span><span class="va">top</span><span class="op">$</span><span class="va">words</span>,</span>
<span>                          model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                          df <span class="op">=</span> <span class="va">df_train</span>,</span>
<span>                          reference <span class="op">=</span> <span class="st">"pop"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="drop-similar-terms">Drop similar terms<a class="anchor" aria-label="anchor" href="#drop-similar-terms"></a>
</h2>
<p>The resulting list of words is quite long and includes a lot of
redundancy. Note that unlike in traditional dictionary approaches, the
DDR method performs better if the input dictionary is very short and
clear-cut. While redundancy is not a problem for traditional
dictionaries, it may distort the performance of the dictionary in DDR
(Garten et al., 2018).</p>
<p><code>remove_similar_words</code> helps us to detect similar terms -
by computing the pairwise cosine similarity between all words
representations in a datafram. It can use two score as input to decide
which words to drop: Here we use the F1 score calculated before
<code>popF1</code>, and the number of occurences
(<code>compare_hits = T</code>). We set the function to compare only
terms that reach a smiliarity of 60% (<code>min_simil = .6</code>).
<code>win_threshold</code> defines the share of all comparisons that a
term must win in order to remain in the dataframe.</p>
<p>Additionally, we drop terms that originate from the uni-word
<code>afd</code>, the German populist party, since we want our populism
measure to be rather non-partisan:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## narrow down</span></span>
<span><span class="va">top_subs</span> <span class="op">&lt;-</span> <span class="va">top</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/remove_similar_words.html">remove_similar_words</a></span><span class="op">(</span><span class="va">model</span>, </span>
<span>                                        compare_by <span class="op">=</span> <span class="st">"popF1"</span>,</span>
<span>                                        compare_hits <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                                        min_simil <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>                                        win_threshold <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">from</span> <span class="op">==</span> <span class="st">"afd"</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="narrowing-down-by-hand">Narrowing down by hand<a class="anchor" aria-label="anchor" href="#narrowing-down-by-hand"></a>
</h2>
<p>Let’s have a look at all terms found so far. (We won’t print all 400
or so terms here but only the top 50)</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_subs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">popF1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">words</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "panzer"                 "örr"                    "verrechnet"            </span></span>
<span><span class="co">#&gt;  [4] "örr zwangsgebühr"       "deutschen steuerzahler" "existenzen vernichtet" </span></span>
<span><span class="co">#&gt;  [7] "wand"                   "autofahrer"             "gaga"                  </span></span>
<span><span class="co">#&gt; [10] "wahn"                   "irrsinnige"             "rücken wand"           </span></span>
<span><span class="co">#&gt; [13] "irrweg"                 "vernichtet"             "rechnet"               </span></span>
<span><span class="co">#&gt; [16] "bargeld"                "merkels groko"          "kette"                 </span></span>
<span><span class="co">#&gt; [19] "lobbyregister"          "vdk"                    "deckmantel"            </span></span>
<span><span class="co">#&gt; [22] "mdb groko"              "gender gaga"            "deckt"                 </span></span>
<span><span class="co">#&gt; [25] "autofahren"             "diesel benziner"        "groko plant"           </span></span>
<span><span class="co">#&gt; [28] "entlarven"              "steuerzahler"           "teure"                 </span></span>
<span><span class="co">#&gt; [31] "abgasnorm"              "benziner"               "daimler vw"            </span></span>
<span><span class="co">#&gt; [34] "palmöl"                 "seehofer rechnet"       "kleinrechnen"          </span></span>
<span><span class="co">#&gt; [37] "deutschen mittelstand"  "groko importiert"       "skandalösen"           </span></span>
<span><span class="co">#&gt; [40] "betreiber"              "mdb nimmt"              "spahn warnt"           </span></span>
<span><span class="co">#&gt; [43] "unfähig"                "deutsche steuerzahler"  "todesstoß"             </span></span>
<span><span class="co">#&gt; [46] "zwangsgebühr"           "teures"                 "verrückt"              </span></span>
<span><span class="co">#&gt; [49] "geld deutschen"         "steuergelder"</span></span></code></pre></div>
<p>This list of keywors is still quite long. It includes many terms that
seem theoretically plausible, but also many words that obviously are
either too specific, or seem out of place.</p>
<p>Since the next steps involve combinatorics for finding a good
combination of keywords, we want to narrow down the list of words as
drastically as possible.</p>
<p>For theoretical reasons, we decided to group the found words in three
categories that reflect different aspects of populist communication:
Terms that reflect ‘elites’, terms that reflect ‘the people’, and words
that relate those two groups.</p>
<p>From the 400 or so terms, we hand-picked five distinctive terms for
each of these categories. This mode of selection is theory-driven and
different from the inductive logic used so far. You may want to opt for
different modes of selection, depending on your task and the quality of
inductively generated keywords. Here are the words picked for further
processing:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span><span class="st">"altparteien"</span>, </span>
<span><span class="st">"lobby"</span>, </span>
<span><span class="st">"merkels groko"</span>, </span>
<span><span class="st">"regierungsversagen"</span>, </span>
<span><span class="st">"zwangsgebühr"</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">people</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span><span class="st">"arbeitnehmern"</span>,</span>
<span><span class="st">"deutschen steuerzahler"</span>,</span>
<span><span class="st">"existenzen vernichtet"</span>,</span>
<span><span class="st">"mittelstand"</span>,</span>
<span><span class="st">"volkes"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">relation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"irrsinnige"</span>,</span>
<span>  <span class="st">"entlarven"</span>,</span>
<span>  <span class="st">"skandalösen"</span>,</span>
<span>  <span class="st">"unfähig"</span>,</span>
<span>  <span class="st">"realitätsfern"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We use this hand-picked list of words to create a shortlist and add a
variable that indicates the category:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_elites</span> <span class="op">&lt;-</span> <span class="va">top_subs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">words</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">elites</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="st">"elites"</span><span class="op">)</span></span>
<span><span class="va">top_people</span> <span class="op">&lt;-</span> <span class="va">top_subs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">words</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">people</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="st">"people"</span><span class="op">)</span></span>
<span><span class="va">top_relation</span> <span class="op">&lt;-</span> <span class="va">top_subs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">words</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">relation</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="st">"relation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shortlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">top_elites</span>, <span class="va">top_people</span>, <span class="va">top_relation</span><span class="op">)</span> </span>
<span><span class="va">shortlist</span><span class="op">$</span><span class="va">cat</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">shortlist</span><span class="op">$</span><span class="va">cat</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   elites   people relation </span></span>
<span><span class="co">#&gt;        5        5        5</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-combinations">Get combinations<a class="anchor" aria-label="anchor" href="#get-combinations"></a>
</h2>
<p>We now use this shortlist to get all possible combinations of various
length per category, and all possible combinations of these
combinations.</p>
<p><code>get_combis</code> helps us finding these combinations, and
provides a useful random sampling mechanism that limits the number of
returned combinations: Setting a <code>limit</code>, limits the number
of combinations of a given length returned per dimension.</p>
<p>For example, consider that you have a shortlist of words with 2
categories A and B, with 10 words per category, and want find
combinations of words that include at least 3 words per category
(<code>min_per_dim = 3</code>) and maximum 10 words overall
(<code>max_overall = 10</code>), i.e. max. 5 words per dimension.</p>
<p>Then you would have 120 possible combinations of length 3 for both
category A and B:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 120</span></span></code></pre></div>
<p>However, you also get 210 possible combinations of length 4, and 252
combinations of length 5 per category:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 210</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 252</span></span></code></pre></div>
<p>If you want to get all possible combinations of these combinations,
the number increases really quickly, as we can see below. The first two
lines return all possible cominations for A and B of varying length
between 3 and 5. <code>expand_grid</code> returns the combinations of
combinations:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">i</span>, FUN <span class="op">=</span> <span class="va">list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">B_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="va">B</span>, <span class="va">i</span>, FUN <span class="op">=</span> <span class="va">list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">A_c</span>, <span class="va">B_c</span><span class="op">)</span>  <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 338724</span></span></code></pre></div>
<p>Setting the <code>limit</code> to, let’s say 30, in
<code>get_combis</code> radomly draws only 30 possible combinations of
one length per category.</p>
<p>In our case, this limit is not really necessary, as we only have 5
words per category and want lengths between 3 and 4. The maximum number
of combinations per length &amp; category is 10:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>Although unnecessary in our case, we specify a <code>limit</code>
(that won’t drop any combinations) - just for demonstration. Setting
<code>seed</code> makes your results reproducible, the default is
<code>1</code>. <code>get_cobmis</code> returns a data.frame that
includes a column where you’re settings are stored, in case you want to
come back and draw a different round of combinations.</p>
<p>So, let’s get all combinations for our list of words:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combis_rd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_combis.html">get_combis</a></span><span class="op">(</span><span class="va">shortlist</span>,</span>
<span>                        dims <span class="op">=</span> <span class="st">"cat"</span>,</span>
<span>                        min_per_dim <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                        max_overall <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                        limit <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining, by = "rowid"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="evaluate-combinations">Evaluate combinations<a class="anchor" aria-label="anchor" href="#evaluate-combinations"></a>
</h2>
<p>Now we want to get Recall, Precision, and F1 scores for all of the
3,375 combinations. <code>get_many_RPFs</code> is made for this
task:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combis_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_many_RPFs.html">get_many_RPFs</a></span><span class="op">(</span>keyword_df <span class="op">=</span> <span class="va">combis_rd</span>,</span>
<span>                             keyword_field <span class="op">=</span> <span class="st">"combs_split"</span>,</span>
<span>                             model <span class="op">=</span> <span class="va">model</span>, </span>
<span>                             text_df <span class="op">=</span> <span class="va">df_train</span>,</span>
<span>                             reference <span class="op">=</span> <span class="st">"pop"</span>, </span>
<span>                             text_field <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining, by = "rowid"</span></span></code></pre></div>
<p>Now, let’s pick the best performing short dictionary:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pick dictionary that maximizes F1:</span></span>
<span><span class="va">dict</span>  <span class="op">&lt;-</span> <span class="va">combis_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">F1</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">F1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">combs_split</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's see:</span></span>
<span><span class="va">dict</span></span>
<span><span class="co">#&gt; [1] "altparteien"            "deutschen steuerzahler" "existenzen vernichtet" </span></span>
<span><span class="co">#&gt; [4] "irrsinnige"             "mittelstand"            "regierungsversagen"    </span></span>
<span><span class="co">#&gt; [7] "skandalösen"            "unfähig"                "zwangsgebühr"</span></span></code></pre></div>
<p>These 10 words nicely cover various aspects of populist
communication. However, this is not the place to dive into theoretical
discussions.</p>
<p>Let’s check the performance of the dictionary instead. On the
training sample, this dictionary reaches an F1 of .55, which is not
great, but OK.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combis_df</span><span class="op">$</span><span class="va">F1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; [1] 0.5490196</span></span></code></pre></div>
<p>Let’s check the F1 score when applied on the test sample:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Performance for test_df</span></span>
<span><span class="fu"><a href="../reference/get_F1.html">get_F1</a></span><span class="op">(</span><span class="va">df_test</span>, <span class="va">dict</span>, <span class="va">model</span>, <span class="st">'pop'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4791667</span></span></code></pre></div>
<p>The short dictionary reaches a F1 of .48 in the test sample, which is
a somewhat weaker performance than in the train data.</p>
<p>For a real application, this might be considered a too weak
performance. Pathways to improve this performance are discussed in the
concluding section. Please note that the purpose of this vignette is not
to demonstrate the performance of the DDR approach, but to introduce the
functions of the package which can be used to enhance this
performance.</p>
<p>For some applications, you might be interested about how your DDR
measurement performs in different subsets of your data, e.g., if you are
using a translated corpus originating from various languages. F1 scores
for grouped subsets of a text-dataframe, can be obtained by
<code>get_many_F1s_by_group</code>.</p>
<p>In our example, we might be interested in finding a dictionary that
performs well for predicting populist communication of different
political parties. Here, we demonstrate the function using the top 5% of
short dictionaries. We focus on the overall performance, and the
performance in predicting populist communication for the right-wing and
left-wing populist parties AfD and Die Linke. We calculate the 3rd root
of the product of the overall F1 score and the two party-specific
F1-scores to pick the best performing ‘balanced’ dictionary:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combis_subset</span> <span class="op">&lt;-</span> <span class="va">combis_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/filter_ntile.html">filter_ntile</a></span><span class="op">(</span><span class="st">"F1"</span>, <span class="fl">.95</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combis_df_by_group</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/get_many_F1s_by_group.html">get_many_F1s_by_group</a></span><span class="op">(</span>keyword_df <span class="op">=</span> <span class="va">combis_subset</span>,</span>
<span>                                             keyword_field <span class="op">=</span> <span class="st">"combs_split"</span>,</span>
<span>                                             id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                                             model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                                             text_df <span class="op">=</span> <span class="va">df_train</span>,</span>
<span>                                             group_field <span class="op">=</span> <span class="st">"party"</span>,</span>
<span>                                             reference <span class="op">=</span> <span class="st">'pop'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining, by = "id"</span></span>
<span><span class="co"># Compute 3rd root product of 3 F1s:</span></span>
<span><span class="va">combis_df_by_group</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>F1_balanced <span class="op">=</span> <span class="op">(</span><span class="va">F1</span><span class="op">*</span><span class="va">F1_AfD</span><span class="op">*</span><span class="va">F1_Linke</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dict_bal</span>  <span class="op">&lt;-</span> <span class="va">combis_df_by_group</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">F1_balanced</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">F1_balanced</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">combs_split</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dict_bal</span></span>
<span><span class="co">#&gt;  [1] "arbeitnehmern"          "deutschen steuerzahler" "existenzen vernichtet" </span></span>
<span><span class="co">#&gt;  [4] "lobby"                  "merkels groko"          "mittelstand"           </span></span>
<span><span class="co">#&gt;  [7] "realitätsfern"          "skandalösen"            "unfähig"               </span></span>
<span><span class="co">#&gt; [10] "zwangsgebühr"</span></span></code></pre></div>
<p>Let’s check the performance of this ‘balanced’ dictionary on the test
data:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_F1.html">get_F1</a></span><span class="op">(</span><span class="va">df_test</span>, <span class="va">dict_bal</span>, <span class="va">model</span>, <span class="st">'pop'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4948454</span></span></code></pre></div>
<p>This more balanced dictionary performs slightly better in the test
sample. Also, it drops keywords that are more or less exclusively used
by the right-wing AfD, like ‘altparteien’ (translated: ‘old
parties’).</p>
</div>
<div class="section level2">
<h2 id="apply-ddr">Apply DDR<a class="anchor" aria-label="anchor" href="#apply-ddr"></a>
</h2>
<p>Having decided on a final dictionary, we want to apply this
dictionary using the DDR method to the datasets. We apply it on both,
the population data <code>tw_data</code> and the annotated data
<code>tw_annot</code>, using the core function of this package
<code>cossim2dict</code>. This function can also fill in missing values,
which occur sometimes if text cleaning empties the text field. Here, we
fill it by the mean minus 1 SD:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tw_annot</span><span class="op">$</span><span class="va">pop_ddr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cossim2dict.html">cossim2dict</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">tw_annot</span>,</span>
<span>                               dictionary <span class="op">=</span> <span class="va">dict_bal</span>,</span>
<span>                               model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                               replace_na <span class="op">=</span> <span class="st">'mean-sd'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tw_data</span><span class="op">$</span><span class="va">pop_ddr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cossim2dict.html">cossim2dict</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">tw_data</span>,</span>
<span>                               dictionary <span class="op">=</span> <span class="va">dict_bal</span>,</span>
<span>                               model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                               replace_na <span class="op">=</span> <span class="st">'mean-sd'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="face-validity">Face validity<a class="anchor" aria-label="anchor" href="#face-validity"></a>
</h2>
<p>Now, lets inspect the top 6 populist Tweets in our population
data:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tw_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">pop_ddr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">full_text</span>, <span class="va">party</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                              Linke </span></span>
<span><span class="co">#&gt;     "#Scheuer ist als Minister unfähig &amp;amp; untragbar! Vom PKW-Maut-Desaster über ÖPP-Straßenprojekte bis zur Autobahn GmbH: Wie lange will #Merkel noch zusehen, wie unser Steuergeld für private Beratungsfirmen, Investoren und überbezahlte Manager veruntreut wird? https://t.co/4x0a2UhuIh" </span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                              Linke </span></span>
<span><span class="co">#&gt; "Grotesk: #Lufthansa-Führung erpresst Beschäftigte mit Stellenabbau &amp;amp; betreibt weiter Tochterunternehmen in Steueroasen. Ohne Einfluss auf Geschäftspolitik entpuppen sich #BuReg-Staatshilfen so zT als Subvention zukünftiger Profite &amp;amp; Verrat an Arbeitnehmern https://t.co/inARCu6Sqo" </span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                              Linke </span></span>
<span><span class="co">#&gt;        "#DAX-Konzerne machen so viel #Gewinn wie nur zuvor und vernichten Arbeitsplätze in großem Stil. Warum nur haben #Altmaier &amp;amp; #Scholz üppige Rettungsmilliarden an Konzerne verteilt ohne dies an die Auflage zu knüpfen, dass Arbeitsplätze gesichert werden?\nhttps://t.co/lCAMzKRbBj" </span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                                AfD </span></span>
<span><span class="co">#&gt;   "Entwicklungsminister Gerd Müller &amp;amp; Arbeitsminister @hubertus_heil wollen ein Lieferkettengesetz durchsetzen, das eine nahezu unbegrenzte Haftungsausweitung für 🇩🇪 Unternehmen vorsieht. @Frohnmaier_AfD: \"Schlussstrich unter Lieferketten-Irrsinn ziehen\" #AfD https://t.co/mW9wvDrFaI" </span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                                AfD </span></span>
<span><span class="co">#&gt;                                        "#AfD-Fraktionsvize @PeterFelser hat den linksideologischen Hype um neue Geschlechter als „teures #Gendergaga“ kritisiert: \"Riesen Aufwand für Nichts! Gender-Gaga auf Kosten der #Steuerzahler ersatzlos streichen!\" #Bundestag https://t.co/paIVvtTkfg" </span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                                AfD </span></span>
<span><span class="co">#&gt;                           "Franziska #Giffey will Hilfen aus dem #Konjunkturpaket nur an Unternehmen zahleen, die ‚Frauenquoten‘ erfüllen. Dazu @M_Reichardt_AfD: \"Wenig für Familien – Milliarden für ideologische Projekte!\" #Corona #Bundesregierung #Bundestag #AfD https://t.co/SJkeKpMN2f"</span></span></code></pre></div>
<p>These examples include Tweets from both populist parties ‘AfD’ and
‘Die Linke’. Judging from face validity these Tweets seem clearly
populist.</p>
<p>Let’s inspect the lower end of the spectrum:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tw_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">pop_ddr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">full_text</span>, <span class="va">party</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                    CSU </span></span>
<span><span class="co">#&gt; "@KristinaFassler @KenzaAbbou @KaiDiekmann @katha_krentz @lukizzl @SophiaRoediger @TijenOnaran @cihansugur @anja_hendel @esinekalos @froileinmueller @biancareitz_ @wohlrapp @pmk997 @swissmadame @ChrisBoesenberg Gute Besserung ❤️‍🩹" </span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                               B90Grune </span></span>
<span><span class="co">#&gt;                                                                                                                                                                                             "@ralphruthe @marga_owski Gute Besserung!" </span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                    CSU </span></span>
<span><span class="co">#&gt;                                                                                                                                                                            "@grischdjane @doktordab @MarkusBlume So ein Käse Käse ;-)"</span></span></code></pre></div>
<p>The least populist Tweets - according to our measurement here -
include quite harmless “get well soon” wishes.</p>
</div>
<div class="section level2">
<h2 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h2>
<p>Let’s use the DDR measurements for some plots. We start with plotting
the gradual populism measurement against the human, binary coding for
populism, using the complete annotated dataset:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tw_annot</span><span class="op">$</span><span class="va">pop</span> <span class="op"><a href="../reference/compound.html">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tw_annot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pop</span>, y <span class="op">=</span> <span class="va">pop_ddr</span>, color <span class="op">=</span> <span class="va">pop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Populism (DDR)"</span>, </span>
<span>       x <span class="op">=</span> <span class="st">"Populism (Human coding)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>        legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="from_text_to_measurement_files/figure-html/plot%20against%20manual%20coding-1.png" width="75%"></p>
<p>We see that some non-populist Tweets score higher than they should,
but the mean populism score for both groups is clearly different - as
indicated by the boxplots.</p>
<p>We can also use the parallel-coded 90 Tweets to get some visual
evaluation for the gradual measurement returned by the DDR method.
‘Populism’ in the annotated dataset was coded as two distinct
categories, anti-elitism and people-centrism. To obtain some gradual
score, we just calculate the sum of the coding of these two categories
by the two coders, resulting in a score that ranges from 0 to 4. We plot
it against the DDR score:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parallel_df</span> <span class="op">&lt;-</span> <span class="va">tw_annot</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rel_test</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pop_cum <span class="op">=</span> <span class="va">ppc_A</span> <span class="op">+</span> <span class="va">ppc_B</span> <span class="op">+</span> <span class="va">ane_A</span> <span class="op">+</span> <span class="va">ane_B</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">parallel_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pop_ddr</span>, y <span class="op">=</span> <span class="va">pop_cum</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="from_text_to_measurement_files/figure-html/against%20parallel%20coded%20tweets-1.png" width="75%"></p>
<p>The two (semi-)continuous scores have a Pearson’s r correlation of
.53:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">parallel_df</span><span class="op">$</span><span class="va">pop_cum</span>, <span class="va">parallel_df</span><span class="op">$</span><span class="va">pop_ddr</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.521855</span></span></code></pre></div>
<p>Finally, to assess external validity of our measurement, we compare
it on a aggregated level to the POPPA expert rating of political parties
(Meijers and Zaslove, 2020). This expert survey provides a gradual
rating of populism for political parties. The score is already merged to
the <code>tw_data</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># aggregate on party level</span></span>
<span><span class="va">tw_party</span> <span class="op">&lt;-</span> <span class="va">tw_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">party</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>pop_ddr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pop_ddr</span><span class="op">)</span>,</span>
<span>                        poppa_populism <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">poppa_populism</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tw_party</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pop_ddr</span>, y <span class="op">=</span> <span class="va">poppa_populism</span>, label<span class="op">=</span><span class="va">party</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>, vjust<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="from_text_to_measurement_files/figure-html/Plot%20agaginst%20POPPA%20expert%20survey-1.png" width="75%"></p>
<p>On an aggregate level, the expert ratings of populism for the
political parties align very well with the DDR score for populist
communication.</p>
<p>Indeed, both scores are strongly correlated:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">tw_party</span><span class="op">$</span><span class="va">pop_ddr</span>, <span class="va">tw_party</span><span class="op">$</span><span class="va">poppa_populism</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8667536</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simple-visual-analysis">Simple visual analysis<a class="anchor" aria-label="anchor" href="#simple-visual-analysis"></a>
</h2>
<p>The resulting DDR scores could be used, e.g. to investigate temporal
shifts in the strategies of the political parties. Below we plot the
mean populism score per party over time. We see that the ‘AfD’ clearly
is the most populist party, followed by ‘Die Linke’, which is
theoretically plausible. We note a sudden decrease of populist
communication for ‘Die Linke’ and other parties in August 2020, which
could be driven by the growth of a populist coronasceptic movement -
which was opposed by all parties but the ‘AfD’. At the end of the
timeframe, shortly before the German General Elections in September
2021, the level of populism rises notably for the ‘AfD’.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tw_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">created_at</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">party</span>, <span class="va">day</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>pop_ddr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pop_ddr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">pop_ddr</span>, color <span class="op">=</span> <span class="va">party</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'loess'</span>, span <span class="op">=</span> <span class="fl">0.15</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="from_text_to_measurement_files/figure-html/simple%20visualization-1.png" width="75%"></p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Summing up, the dictionary and measurement produced in this vignette
does a good job in differentiating levels of populism in the
communication of political parties, on an aggregate level. It also
produces somehow plausible results when compared to the cumulative
coding of the two coders. And it performs OK when compared directly to
the binary hand-codings of Tweets.</p>
<p>However, there is much room for improvement. Here are some possible
ways to improve the measurement:</p>
<ul>
<li><p>Improve the fastText model by using a much larger training
dataset. Pre-trained models are trained on millions of sentences, for
example. However, unlike those generic models, you may want stick with
material from the specific context (here: communication of political
elites).</p></li>
<li><p>Improve the fastText model by parameter tuning. E.g., donsider
increasing the number of dimensions (<code>dim</code>, 100-300 are
popular choices), increasing the number of epochs (<code>epoch</code>),
play around with different ngram lengths (<code>minn</code>,
<code>maxn</code>), and play around with the window size for context
(<code>ws</code>). You can use <code>get_nn</code> for face validity
plausibility checks, or use a more formal test (e.g., analogy tests) to
determine the quality of your fastText model.</p></li>
<li><p>Use a larger annotated sample for finding good keywords and
evaluating their quality. The larger this sample, the lower the risk of
overfitting your short dictionary to a too specific context.</p></li>
<li><p>Play around with different thresholds in
<code>remove_similar_terms</code>. This function can have a quite
dramatic effect of the words included or excluded.</p></li>
<li><p>Think of a theory-driven, explicit coding-scheme for hand-picking
words from the narrowed down subset.</p></li>
<li><p>Allow for more combinations per length and dimension
(<code>limit</code>) in <code>get_combis</code>.</p></li>
</ul>
<p>Good luck!</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bojanowski, P., Grave, E., Joulin, A., &amp; Mikolov, T. (2017).
Enriching Word Vectors with Subword Information. ArXiv:1607.04606 [Cs].
Retrieved from <a href="http://arxiv.org/abs/1607.04606" class="external-link">http://arxiv.org/abs/1607.04606</a></p>
<p>Chinchor, N. (1992). MUC-4 evaluation metrics. Proceedings of the 4th
Conference on Message Understanding, 22–29. USA: Association for
Computational Linguistics. <a href="https://doi.org/10.3115/1072064.1072067" class="external-link">https://doi.org/10.3115/1072064.1072067</a></p>
<p>Garten, J., Hoover, J., Johnson, K. M., Boghrati, R., Iskiwitch, C.,
&amp; Dehghani, M. (2018). Dictionaries and distributions: Combining
expert knowledge and large scale textual data content analysis. Behavior
Research Methods, 50(1), 344–361. <a href="https://doi.org/10.3758/s13428-017-0875-9" class="external-link">https://doi.org/10.3758/s13428-017-0875-9</a></p>
<p>Grimmer, J., &amp; Stewart, B. M. (2013). Text as data: The promise
and pitfalls of automatic content analysis methods for political texts.
Political Analysis, 21(3), 267–297. <a href="https://doi.org/10.1093/pan/mps028" class="external-link">https://doi.org/10.1093/pan/mps028</a></p>
<p>Meijers, M., &amp; Zaslove, A. (2020). Populism and Political Parties
Expert Survey 2018 (POPPA) (Data set). Harvard Dataverse. <a href="https://doi.org/10.7910/DVN/8NEL7B" class="external-link">https://doi.org/10.7910/DVN/8NEL7B</a></p>
<p>Thiele, D. (2022, June 27). “Don’t believe the media’s pandemic
propaganda!!” How Covid-19 affected populist Facebook user comments in
seven European countries. Presented at the ICA Regional Conference 2022.
Computational Communication Research in Central and Eastern Europe,
Helsinki, Finland. Retrieved from <a href="https://ucloud.univie.ac.at/index.php/s/PzGzChXroLCXrtt" class="external-link">https://ucloud.univie.ac.at/index.php/s/PzGzChXroLCXrtt</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniel Thiele.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
